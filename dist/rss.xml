
export async function GET({ site }) {
    const pages = import.meta.glob('./blog/*.astro');
    const baseUrl = site || 'https://jetnexo.com.br';

    // Metadata Map for Viral Articles (Hardcoded for "Automation" of quality)
    const metaMap = {
        // Original 6
        'ia-que-vende': {
            title: "IA que vende enquanto voc√™ dorme: O fim do atendente zumbi",
            description: "Descubra como uma IA pode vender 24h por dia sem pedir caf√©, sem dormir e sem reclamar do chefe.",
            pubDate: "2026-01-15T00:00:00Z"
        },
        'como-dobrar-vendas': {
            title: "Como dobrar suas vendas sem trazer um √∫nico cliente novo",
            description: "A arte do Upsell Autom√°tico: como transformar um pedido de R$ 100 em R$ 180 sem esfor√ßo.",
            pubDate: "2026-01-15T01:00:00Z"
        },
        'erros-que-sua-ia-comete': {
            title: "3 Erros est√∫pidos que sua automa√ß√£o comete (e voc√™ nem sabe)",
            description: "Menu num√©rico? Loop infinito? Demora pra responder? Voc√™ est√° queimando dinheiro.",
            pubDate: "2026-01-15T02:00:00Z"
        },
        'adeus-carrinho-abandonado': {
            title: "Adeus Carrinho Abandonado: A estrat√©gia de R$ 12k/m√™s",
            description: "Como recuperar 75% dos carrinhos abandonados sem ser chato e sem dar desconto de cara.",
            pubDate: "2026-01-15T03:00:00Z"
        },
        'atendimento-3-0': {
            title: "Atendimento 3.0: O novo padr√£o do mercado",
            description: "O cliente de 2026 n√£o espera mais. Ou voc√™ √© imediato, ou voc√™ √© irrelevante.",
            pubDate: "2026-01-15T04:00:00Z"
        },
        'ia-vendeu-8k': {
            title: "IA vendeu R$ 8 mil em 24h: como replicar",
            description: "Estudo de caso real de como uma IA simples superou uma equipe inteira de vendas em um feriado.",
            pubDate: "2026-01-14T10:00:00Z"
        },

        // Batch 1 (Items 1-20)
        'ia-que-vende-sozinha': {
            title: "IA que vende sozinha: como dobrar convers√£o em 30 dias",
            description: "Automa√ß√£o de vendas no chat: JetNexo transforma suporte em lucro.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'chatbot-x-ia': {
            title: "Chatbot x IA: por que 90% falha e 10% fatura alto",
            description: "Chatbot responde FAQ. IA vende no meio da dor. Entenda a diferen√ßa de R$ 10k/m√™s.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'erros-que-sua-ia-comete': {
            title: "12 erros fatais que sua IA comete (e como corrigir)",
            description: "Dizer 'N√£o entendi' mata venda. Veja como criar fallbacks que convertem.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'roi-suporte-automatizado': {
            title: "Como medir ROI de suporte: f√≥rmula simples",
            description: "A matem√°tica que prova que o JetNexo se paga em 2 dias.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'respostas-frete-devolucao': {
            title: "Frete, devolu√ß√£o, troca: respostas em 2s",
            description: "10 respostas prontas que transformam burocracia em venda.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'suporte-24h-sem-humano': {
            title: "Suporte 24h sem humano: sim, √© poss√≠vel",
            description: "Como economizar 70% da folha de pagamento e vender de madrugada.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'upsell-no-chat': {
            title: "Upsell no chat: 10 frases que dobram o ticket",
            description: "Frases psicol√≥gicas para aumentar o valor do pedido sem ser chato.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'instalar-jetnexo': {
            title: "Como instalar JetNexo em 90 segundos",
            description: "Tutorial passo a passo. Copiou, colou, vendeu.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'ia-portugues': {
            title: "IA que entende portugu√™s de verdade",
            description: "G√≠ria, sotaque e emo√ß√£o. Ela sabe o que √© 't√¥ puto'.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'whatsapp-jetnexo': {
            title: "WhatsApp Business + JetNexo: integra√ß√£o gr√°tis",
            description: "Atenda no Zap e venda no Zap com um link webhook.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'jetnexo-dropshipping': {
            title: "JetNexo para Dropshipping: Salvando opera√ß√µes",
            description: "Frete longo? Devolu√ß√£o? A IA segura a onda e evita chargeback.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'historico-compras-chat': {
            title: "Hist√≥rico de compras direto no chat",
            description: "Cliente ama ser lembrado. 'Quer repetir o de 2025?'",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'abandono-carrinho': {
            title: "Abandono de carrinho: recupere 70% em 1 minuto",
            description: "IA manda mensagem na hora certa. 'Perdido no checkout?'",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'multi-canal': {
            title: "Um √∫nico JetNexo para tudo",
            description: "WhatsApp, Site, Instagram, Telegram. Tudo num c√©rebro s√≥.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'lojas-fisicas': {
            title: "Lojas F√≠sicas: JetNexo na porta e no celular",
            description: "QR Code na vitrine mostra estoque real e reserva pe√ßas.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'ticket-medio': {
            title: "Ticket m√©dio: como subir 40% sem mudar pre√ßo",
            description: "Ofertas din√¢micas baseadas no carrinho atual.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'mensagem-pos-compra': {
            title: "IA escreve mensagem p√≥s-compra",
            description: "Encante o cliente depois do cart√£o passar.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'atendimento-noturno': {
            title: "Atendimento Noturno: Por que sua loja precisa",
            description: "3h da manh√£ √© hora de resolver BO e vender.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'zapier-vs-jetnexo': {
            title: "Concorrente: Zapier + OpenAI vs JetNexo",
            description: "Por que montar frankenstein sai caro.",
            pubDate: "2026-01-16T12:00:00Z"
        },
        'criei-jetnexo-7-dias': {
            title: "Como eu criei o JetNexo em 7 dias",
            description: "Minha hist√≥ria: De R$ 1.000 no bolso a faturar 50x mais.",
            pubDate: "2026-01-16T12:00:00Z"
        },

        // Batch 2 (Items 21-50)
        'jetnexo-vs-humano-quem-fecha-mais': {
            title: "JetNexo vs. Atendente Humano: Quem fecha mais?",
            description: "Dados de 1.200 tickets mostram o massacre: IA custa R$ 0,67 por venda contra R$ 19 do humano.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'nao-quero-bot-como-converter': {
            title: "N√£o quero bot: Como converter quem odeia IA",
            description: "A frase m√°gica que transforma 'quero falar com gente' em 'obrigado pela ajuda'.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'ia-detecta-medo-de-compra': {
            title: "IA que detecta 'medo de compra' e vira o jogo",
            description: "Como usar a an√°lise de sentimento para identificar inseguran√ßa e jogar a prova social na mesa.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'streak-de-fidelidade-no-chat': {
            title: "O Streak de Fidelidade: Viciando o cliente",
            description: "Gamification no WhatsApp: 'Bom te ver pelo 3¬∫ dia seguido! Ganhou pr√™mio.'",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'qr-code-embalagem-vende': {
            title: "O QR Code na embalagem que imprime dinheiro",
            description: "Cliente abre a caixa, escaneia e cai direto num upsell irresist√≠vel.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'jetnexo-para-cursos-online': {
            title: "JetNexo para Cursos Online: A Escassez Real",
            description: "S√≥ mais 3 alunos para fechar a turma. A IA avisa e fecha.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'reembolso-virar-upsell': {
            title: "Como transformar Reembolso em Upsell",
            description: "Vou te devolver, mas antes: que tal levar o Premium pela metade do pre√ßo?",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'mensagem-aniversario-cliente': {
            title: "Feliz Anivers√°rio (que vende)",
            description: "A √∫nica mensagem de parab√©ns que o cliente realmente quer receber.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'jetnexo-marketplace-shopee': {
            title: "JetNexo para Marketplace: Shopee e ML",
            description: "Responda avalia√ß√£o negativa em 5 segundos e vire 5 estrelas.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'avaliacao-pos-compra-automatica': {
            title: "Avalia√ß√£o P√≥s-Compra Autom√°tica",
            description: "Troque 5 estrelas por 10% de desconto. O loop viral perfeito.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'ia-fala-com-voz-whatsapp': {
            title: "IA que manda √°udio no WhatsApp",
            description: "Texto √© frio. Voz √© venda. Taxa de abertura de √°udio √© de 90%.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'como-jetnexo-se-paga-no-primeiro-dia': {
            title: "Como a JetNexo se paga no dia 1",
            description: "Case real: loja de cosm√©tico vendeu 3 batons extras em 40 minutos.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'modo-noturno-cliente-bebado': {
            title: "Modo Noturno: Atendendo √†s 2 da maanh√£",
            description: "O cliente bebeu, gostou, comprou. A IA n√£o julga, ela fatura.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'jetnexo-para-servicos': {
            title: "JetNexo para Servi√ßos: Sal√£o e Mec√¢nico",
            description: "Seu corte t√° marcado. Quer adicionar hidrata√ß√£o por +R$30?",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'tempo-resposta-milissegundo': {
            title: "O Poder do Milissegundo (TTFB)",
            description: "Dashboard mostra: Humano leva 4.2s. JetNexo leva 0.07s.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'jetnexo-black-friday': {
            title: "Black Friday: 24h sem dormir",
            description: "800 tickets em um dia. Zero erros. R$ 142k no caixa.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'ia-instagram-dm-whatsapp': {
            title: "Do Instagram DM para o WhatsApp",
            description: "Tire o cliente da distra√ß√£o do Insta e leve pro fechamento no Zap.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'politica-privacidade-converte': {
            title: "Pol√≠tica de Privacidade que Converte",
            description: "Seus dados ficam aqui. Seguran√ßa √© argumento de venda.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'jetnexo-para-ongs': {
            title: "JetNexo Gr√°tis para ONGs",
            description: "Atenda mais gente, gaste menos. A gente banca a tecnologia.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'ab-test-respostas-chat': {
            title: "A/B Test no Chat: Ci√™ncia da Venda",
            description: "'Desconto?' vs 'Quer ganhar?'. A segunda converte 28% mais.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'jetnexo-food-delivery': {
            title: "JetNexo para Delivery: Fome n√£o espera",
            description: "Pediu, chegou. Entrega confirmada em 28 minutos.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'ia-le-humor-emoji': {
            title: "IA que l√™ humor pelo Emoji",
            description: "üò° √© urg√™ncia. üòç √© upsell. A IA sabe a diferen√ßa.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'jetnexo-telegram-grupos': {
            title: "Grupos de Telegram que vendem sozinhos",
            description: "A IA gerencia a comunidade, tira d√∫vidas e modera.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'treinei-ia-sotaques': {
            title: "Treinei a IA para falar 'Carioca' e 'Baiano'",
            description: "Regionaliza√ß√£o gera conex√£o. 'T√° osso' ou 'Massa'?",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'jetnexo-revenda-afiliados': {
            title: "Ganhe dinheiro revendendo JetNexo",
            description: "Indique uma loja e ganhe 20% de comiss√£o recorrente.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'ia-lembra-6-meses': {
            title: "A IA que lembra de voc√™ 6 meses depois",
            description: "'Oi Ana, seu t√™nis deve estar gasto. Chegou o modelo novo.'",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'jetnexo-para-blogueiros': {
            title: "Monetize seu Blog com Chat",
            description: "O leitor tem d√∫vida sobre o post? Venda o produto ali mesmo.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'instalacao-wordpress-1-clique': {
            title: "Instala√ß√£o WordPress em 1 Clique",
            description: "Plugin gr√°tis. Copiou, colou, t√° vendendo.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'jetnexo-viagem-internacional': {
            title: "Vendas Internacionais via Chat",
            description: "Frete para os EUA cotado em segundos. D√≥lar ou Real.",
            pubDate: "2026-01-16T10:00:00Z"
        },
        'relatorio-mensal-automatico': {
            title: "O Relat√≥rio que d√° gosto ler",
            description: "Dia 1 chega o PDF: R$ 7.430 gerados. 312 clientes salvos.",
            pubDate: "2026-01-16T10:00:00Z"
        }
    };

    // Dynamically find blog posts
    const rssItems = [];
    for (const path in pages) {
        const slug = path.split('/').pop().replace('.astro', '');
        if (slug === 'index') continue;

        const meta = metaMap[slug] || {
            title: `Artigo: ${slug.replace(/-/g, ' ')}`,
            description: "Leia mais sobre este t√≥pico no blog da JetNexo.",
            pubDate: new Date().toISOString()
        };

        rssItems.push(`
        <item>
            <title><![CDATA[${meta.title}]]></title>
            <link>${baseUrl}/blog/${slug}</link>
            <guid isPermaLink="true">${baseUrl}/blog/${slug}</guid>
            <description><![CDATA[${meta.description}]]></description>
            <pubDate>${new Date(meta.pubDate).toUTCString()}</pubDate>
        </item>`);
    }

    const rss = `<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>JetNexo Blog</title>
        <link>${baseUrl}</link>
        <description>Dicas de vendas com IA, automa√ß√£o e futuro do e-commerce.</description>
        <language>pt-br</language>
        <lastBuildDate>${new Date().toUTCString()}</lastBuildDate>
        <atom:link href="${baseUrl}/rss.xml" rel="self" type="application/rss+xml" />
        ${rssItems.join('')}
    </channel>
</rss>`;

    return new Response(rss, {
        headers: {
            'Content-Type': 'application/xml',
            'Cache-Control': 'max-age=3600'
        }
    });
}
