const { title, description, image, type } = Astro.props;
const currentPath = Astro.url.pathname;
const canonicalURL = new URL(currentPath, Astro.site);
const pageTitle = title ? `${title} - JetNexo` : 'JetNexo';
const metaDescription = description || "JetNexo: IA de atendimento que vende sozinha. Reduz 90% dos tickets, aumenta 30% das vendas. Sem drama.";
const ogImage = image || "https://jetnexo.com.br/assets/og-default.png";
const ogType = type || "website";
---

<!doctype html>
<html lang="pt-BR">
	<head>
        <meta charset="UTF-8" />
		<meta name="description" content={metaDescription} />
        <meta name="keywords" content="suporte IA, chatbot vendedor, automa√ß√£o de vendas, upsell autom√°tico, e-commerce Brasil" />
		<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
        <meta name="theme-color" content="#FF0033" />
        <meta name="robots" content="index,follow" />

        <!-- OG Tags (Dynamic) -->
        <meta property="og:site_name" content="JetNexo" />
        <meta property="og:url" content={`https://jetnexo.com.br${currentPath}`} />
        <meta property="og:type" content={ogType} />
        <meta property="og:locale" content="pt_BR" />
        <meta property="og:title" content={pageTitle} />
        <meta property="og:description" content={metaDescription} />
        <meta property="og:image" content={ogImage} />
        
        <!-- Twitter -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:creator" content="@jetnexo_br" />
        
        <!-- 1. Hreflang -->
        <link rel="alternate" hreflang="pt-BR" href={`https://jetnexo.com.br${currentPath}`} />
        <link rel="alternate" hreflang="en" href={`https://jetnexo.com.br/en${currentPath}`} />
        
        
        <!-- 3. Canonical -->
        <link rel="canonical" href={canonicalURL} />
        
        <!-- PERFORMANCE: 124% Speed Kit -->
        <link rel="dns-prefetch" href="//api.jetnexo.com.br" />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        
        <!-- 7/10. Preload (Everything that matters) -->
        <link rel="preload" href="/_astro/critical.css" as="style" />
        <link rel="preload" href="/fonts/inter.woff2" as="font" type="font/woff2" crossorigin />
        
        <style>
            @font-face {
                font-family: 'Inter';
                font-style: normal;
                font-weight: 100 900;
                font-display: swap;
                src: url('/fonts/inter.woff2') format('woff2');
            }
        </style>

        <link rel="preload" href="/assets/vendor.css" as="style" />
        <link rel="preload" href="/assets/chat-widget.js" as="script" />
        
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <link rel="manifest" href="/manifest.json" />
        <meta name="generator" content={Astro.generator} />

    <!-- SECURITY: CSP & Anti-Frame -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://www.googletagmanager.com;
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
        img-src 'self' data: https:;
        font-src 'self' https://fonts.gstatic.com;
        connect-src 'self' https://api.jetnexo.com.br;
        frame-ancestors 'none';
        object-src 'none';
        base-uri 'self';
    ">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
		<title>{pageTitle}</title>

        <!-- Organization + LocalBusiness    <!-- Schema: Bing Friendly (CreativeWork/Article) -->
    <script type="application/ld+json" slot="head" define:vars={{ title, description, image: `https://jetnexo.com.br${Astro.url.pathname === '/' ? '/og-image.jpg' : '/assets/ia-que-vende.jpg'}`, date: new Date().toISOString().split('T')[0] }}>
      {
        "@context": "https://schema.org",
        "@graph": [
          {
            "@type": "Organization",
            "name": "JetNexo",
            "url": "https://jetnexo.com.br",
            "logo": "https://jetnexo.com.br/logo.png"
          },
          {
            "@type": "Article",
            "headline": title,
            "description": description,
            "image": image,
            "datePublished": date,
            "author": {
                "@type": "Organization",
                "name": "JetNexo"
            },
            "creator": {
                "@type": "Organization",
                "name": "JetNexo"
            },
            "publisher": {
                "@type": "Organization",
                "name": "JetNexo",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://jetnexo.com.br/logo.png"
                }
            }
          }
        ]
      }
    </script>
    
    <!-- Scripts -->
    <link rel="manifest" href="/manifest.json">

        <!-- 2. Breadcrumb JSON-LD -->
        <script type="application/ld+json" is:inline set:html={JSON.stringify({
            "@context": "https://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [
                { "@type": "ListItem", "position": 1, "name": "In√≠cio", "item": "https://jetnexo.com.br" },
                { "@type": "ListItem", "position": 2, "name": currentPath.includes('/funcionalidades') ? "Funcionalidades" : (currentPath.includes('/blog') ? "Blog" : "P√°gina"), "item": `https://jetnexo.com.br${currentPath}` }
            ]
        })}></script>

        <!-- Service Worker Registration -->
        <script is:inline>
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/sw.js');
                });
            }
        </script>
	    <!-- 2. Fade-in Animation Engine (Lightweight) -->
    <script is:inline>
      document.addEventListener('DOMContentLoaded', () => {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('fade-in');
            }
          });
        }, { threshold: 0.1 });

        document.querySelectorAll('.fade').forEach(el => observer.observe(el));
      });
    </script>
    <style is:global>
      .fade { opacity: 0; transform: translateY(20px); transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
      .fade-in { opacity: 1; transform: translateY(0); }
    </style>
  </head>
	<body class="bg-black text-white font-sans antialiased overflow-x-hidden selection:bg-red-900 selection:text-white">
        <!-- Sticky Nav (Phase 15) -->
        <nav class="sticky top-0 z-50 bg-black/95 backdrop-blur-sm px-6 py-4 flex items-center justify-between text-white border-b border-red-900 shadow-[0_4px_20px_rgba(255,0,51,0.1)]">
            <a href="/" class="text-2xl font-black text-yellow-400 tracking-tighter hover:scale-105 transition">Jet<span class="text-red-600">Nexo</span></a>
            
            <div class="hidden md:flex space-x-8 font-medium items-center">
                <a href="/" class="hover:text-red-500 transition border-b-2 border-transparent hover:border-red-500 py-1">In√≠cio</a>
                
                <!-- Dropdown 1: Funcionalidades -->
                <div class="relative group">
                    <button class="flex items-center hover:text-yellow-400 transition gap-1 py-4">Funcionalidades <span class="text-xs">‚ñº</span></button>
                    <div class="absolute top-full left-0 mt-0 w-72 bg-gray-900 rounded-xl shadow-[0_10px_40px_rgba(0,0,0,0.9)] border border-gray-800 opacity-0 invisible translate-y-2 group-hover:opacity-100 group-hover:visible group-hover:translate-y-0 transition-all duration-300 transform z-50 p-2">
                        <a href="/funcionalidades/ia-conversa" class="block px-4 py-3 rounded-lg hover:bg-red-900/30 hover:text-red-400 transition">
                            <div class="font-bold text-white">ü§ñ IA Humanizada</div>
                            <div class="text-xs text-gray-400">Conversa natural que conecta.</div>
                        </a>
                        <a href="/funcionalidades/upsell-inteligente" class="block px-4 py-3 rounded-lg hover:bg-yellow-900/30 hover:text-yellow-400 transition">
                            <div class="font-bold text-white">üí∞ Upsell Autom√°tico</div>
                            <div class="text-xs text-gray-400">Aumente o ticket em 25%.</div>
                        </a>
                        <a href="/funcionalidades/pagamento-chat" class="block px-4 py-3 rounded-lg hover:bg-green-900/30 hover:text-green-400 transition">
                            <div class="font-bold text-white">üí≥ Pagamento no Chat</div>
                            <div class="text-xs text-gray-400">Pix e Boleto sem sair.</div>
                        </a>
                    </div>
                </div>

                <!-- Dropdown 2: Para Quem -->
                <div class="relative group">
                    <button class="flex items-center hover:text-yellow-400 transition gap-1 py-4">Para Quem <span class="text-xs">‚ñº</span></button>
                    <div class="absolute top-full left-0 mt-0 w-64 bg-gray-900 rounded-xl shadow-[0_10px_40px_rgba(0,0,0,0.9)] border border-gray-800 opacity-0 invisible translate-y-2 group-hover:opacity-100 group-hover:visible group-hover:translate-y-0 transition-all duration-300 transform z-50 p-2">
                        <a href="/para-ecommerces" class="block px-4 py-3 rounded-lg hover:bg-gray-800 transition">üõçÔ∏è E-commerces</a>
                        <a href="/para-lojas-fisicas" class="block px-4 py-3 rounded-lg hover:bg-gray-800 transition">üè¢ Lojas F√≠sicas</a>
                        <a href="/para-afiliados" class="block px-4 py-3 rounded-lg hover:bg-gray-800 transition">ü§ù Afiliados</a>
                    </div>
                </div>

                <a href="/blog" class="hover:text-red-400 transition">Blog</a>
                <a href="/recursos" class="hover:text-red-400 transition">Recursos</a>
                <a href="/contato" class="hover:text-red-400 transition">Contato</a>
                
                <a href="/precos" class="bg-gradient-to-r from-red-600 to-red-600 hover:from-red-600 hover:to-orange-600 px-6 py-2 rounded-full font-bold shadow-lg hover:shadow-red-900/50 hover:scale-105 transition transform">Come√ßar</a>
            </div>
            
            <!-- Mobile Menu Button -->
            <button class="md:hidden text-2xl text-white">‚ò∞</button>
        </nav>


        <!-- Footer / Privacy Shield -->
        <footer class="bg-black border-t border-gray-900 py-12 mt-20 relative z-10">
            <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-6">
                <div class="text-gray-500 text-sm">
                    &copy; 2026 JetNexo AI. Todos os direitos reservados.
                </div>
                
                <div class="flex items-center gap-6">
                    <a href="/privacidade" class="flex items-center gap-2 text-gray-400 hover:text-green-400 transition group">
                        <svg class="w-5 h-5 text-green-600 group-hover:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>
                        <span class="font-bold text-xs uppercase tracking-wide">Dados Blindados (LGPD)</span>
                    </a>
                    <a href="/termos" class="text-gray-600 hover:text-gray-400 text-sm">Termos</a>
                </div>
            </div>
        </footer>

		<slot />
	</body>
</html>

<style is:global>
	/* Global Styles */
    html {
        scroll-behavior: smooth;
    }
    ::-webkit-scrollbar {
        width: 8px;
    }
    ::-webkit-scrollbar-track {
        background: #111; 
    }
    ::-webkit-scrollbar-thumb {
        background: #FF0033; 
        border-radius: 4px;
    }
</style>
