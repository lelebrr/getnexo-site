---
import '../styles/global.css';
import PreSupportModal from '../components/PreSupportModal.astro';
import AccessibilityControls from '../components/AccessibilityControls.astro';
import CookieConsent from '../components/CookieConsent.astro';
const {
  title = "GetNexo ‚Äì Assistente de Vendas WhatsApp Gr√°tis",
  description = "IA que fecha vendas sozinho 24h. Sem nuvem. Sem mensalidade. Sem risco.",
  keywords = "assistente vendas whatsapp gr√°tis, ia whatsapp vendas, automa√ß√£o whatsapp sem nuvem, getnexo, evolution api, n8n whatsapp, vendas 24h, self hosted ia",
  ogImage = "https://getnexo.com.br/assets/og-poster.jpg",
  isLanding = false,
  preloadImage
} = Astro.props;
---
<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{title}</title>
  <meta name="description" content={description} />
  <meta name="keywords" content={keywords} />
  <meta name="author" content="GetNexo" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href={`https://getnexo.com.br${Astro.url.pathname}`} />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="GetNexo" />
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:image" content={ogImage} />
  <meta name="twitter:card" content="summary_large_image" />
  
  <!-- Verification Tags (Replace content with your codes) -->
    <!-- Critical Resources Preload -->
    <link rel="preload" href="/assets/logo-getnexo.png" as="image" type="image/png">
    <link rel="preload" href="/images/hero-main.avif" as="image" type="image/avif">
    <link rel="preload" href="/images/hero-main.webp" as="image" type="image/webp">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" as="style">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//chat.getnexo.com.br">

  <meta name="google-site-verification" content="" />
  <meta name="msvalidate.01" content="" />

  <slot name="head" />

  <!-- Google Analytics 4 (Non-blocking) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-F8P994EX00"></script>
  
  <script is:inline>
    // Core Web Vitals Monitoring
    function sendToAnalytics(metric) {
      if (window.gtag) {
        gtag('event', metric.name, {
          event_category: 'Web Vitals',
          event_label: metric.id,
          value: Math.round(metric.value),
          custom_map: { metric_value: metric.value }
        });
      }
    }

    // CLS (Cumulative Layout Shift)
    new PerformanceObserver((list) => {
      for (const entry of list.getEntries()) {
        if (!entry.hadRecentInput) {
          sendToAnalytics({
            name: 'CLS',
            value: entry.value,
            id: 'v3-' + Date.now() + '-' + Math.floor(Math.random() * 1000)
          });
        }
      }
    }).observe({ entryTypes: ['layout-shift'] });

    // FID (First Input Delay)
    new PerformanceObserver((list) => {
      for (const entry of list.getEntries()) {
        sendToAnalytics({
          name: 'FID',
          value: entry.processingStart - entry.startTime,
          id: 'v3-' + Date.now() + '-' + Math.floor(Math.random() * 1000)
        });
      }
    }).observe({ entryTypes: ['first-input'] });

    // LCP (Largest Contentful Paint)
    new PerformanceObserver((list) => {
      const entries = list.getEntries();
      const lastEntry = entries[entries.length - 1];
      sendToAnalytics({
        name: 'LCP',
        value: lastEntry.startTime,
        id: 'v3-' + Date.now() + '-' + Math.floor(Math.random() * 1000)
      });
    }).observe({ entryTypes: ['largest-contentful-paint'] });

    // FCP (First Contentful Paint)
    new PerformanceObserver((list) => {
      for (const entry of list.getEntries()) {
        sendToAnalytics({
          name: 'FCP',
          value: entry.startTime,
          id: 'v3-' + Date.now() + '-' + Math.floor(Math.random() * 1000)
        });
      }
    }).observe({ entryTypes: ['paint'] });
  </script>

  <script is:inline>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    // Configura√ß√£o inicial com consentimento default denied
    gtag('consent', 'default', {
      analytics_storage: 'denied',
      ad_storage: 'denied'
    });

    // Configura√ß√£o base GA4
    gtag('config', 'G-F8P994EX00', {
      send_page_view: false // N√£o enviar automaticamente at√© consentimento
    });
  </script>
  
  <!-- Schema.org JSON-LD -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "GetNexo",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "BRL"
      },
      "description": "Assistente de Vendas WhatsApp 100% Gr√°tis. Zero nuvem. Zero risco. Otimize seu atendimento com IA self-hosted."
    }
  </script>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  <style is:global define:vars={{ mainPadding: isLanding ? '0' : '80px', mainMinHeight: isLanding ? 'auto' : '100vh' }}>
    :root { 
      --primary: #00d4ff; 
      --success: #00ff9d; 
      --dark: #030712; 
      --gray: #111827; 
      --light: #f8fafc; 
      --text: #94a3b8; 
      --glass: rgba(15, 23, 42, 0.7);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: 'Inter', system-ui, sans-serif; 
      background: var(--dark); 
      color: var(--light); 
      line-height: 1.6; 
      overflow-x: hidden; 
    }

    /* Premium Common Styles */
    .text-gradient { background:linear-gradient(90deg, #00d4ff, #00ff9d); -webkit-background-clip:text; color:transparent; font-weight: 800; }
    .glass-panel { background: var(--glass); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); border-radius: 20px; }

    /* Foco Vis√≠vel */
    :focus { outline: 3px solid #00ff88; }

    /* Animated Background */
    .animated-bg { position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: -1; overflow: hidden; background: #030712; }
    .blob { position: absolute; width: 600px; height: 600px; background: radial-gradient(circle, rgba(0, 212, 255, 0.08) 0%, transparent 70%); border-radius: 50%; filter: blur(80px); animation: move 20s infinite alternate; }
    .blob-1 { top: -100px; left: -100px; }
    .blob-2 { bottom: -100px; right: -100px; background: radial-gradient(circle, rgba(0, 255, 157, 0.05) 0%, transparent 70%); }
    @keyframes move { from { transform: translate(0, 0); } to { transform: translate(100px, 100px); } }

    /* Layout Parts */
    main { padding-top: var(--mainPadding); min-height: var(--mainMinHeight); }

    .global-header { 
      background: rgba(3, 7, 18, 0.8); 
      backdrop-filter: blur(15px); 
      position: fixed; top: 0; width: 100%; z-index: 1000; 
      padding: 1rem 5%; 
      display: flex; justify-content: space-between; align-items: center; 
      border-bottom: 1px solid rgba(255,255,255,0.05); 
    }
    .logo-link { display: flex; align-items: center; gap: 0.8rem; text-decoration: none; }
    .logo-box { width: 32px; height: 32px; background: linear-gradient(135deg, var(--primary), var(--success)); color: black; display: flex; align-items: center; justify-content: center; font-weight: 900; border-radius: 8px; font-size: 0.9rem; }
    .logo-text { color:white; font-weight: 800; font-size: 1.4rem; margin:0; letter-spacing: -0.5px; }
    .logo-text span { color: var(--success); }

    .nav-links { display: flex; align-items: center; gap: 1.5rem; }
    .nav-links a { color: var(--text); text-decoration: none; font-weight: 600; font-size: 0.9rem; transition: 0.2s; }
    .nav-links a:hover { color: white; }

    .header-ctas { display: flex; align-items: center; gap: 1rem; }
    .btn-login { color: white; text-decoration: none; font-weight: 600; font-size: 0.9rem; }
    .btn-start { background: white; color: black; padding: 0.5rem 1.2rem; border-radius: 10px; font-weight: 700; text-decoration: none; font-size: 0.9rem; transition: 0.3s; min-height: 48px; display: inline-flex; align-items: center; justify-content: center; }
    .btn-start:hover { background: var(--success); transform: translateY(-2px); }

    .global-footer { padding: 5rem 5% 3rem; background: #020617; border-top: 1px solid rgba(255,255,255,0.05); margin-top: 4rem; }
    .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 4rem; max-width: 1200px; margin: 0 auto; }
    .footer-col h4 { color: white; margin-bottom: 1.5rem; font-size: 1.1rem; }
    .footer-col a { display: block; color: var(--text); text-decoration: none; margin-bottom: 0.8rem; font-weight: 500; font-size: 0.9rem; transition: 0.2s; }
    .footer-col a:hover { color: var(--success); }
    .footer-bottom { border-top: 1px solid rgba(255,255,255,0.05); margin-top: 4rem; padding-top: 2rem; text-align: center; color: #475569; font-size: 0.85rem; }

    .floating-whatsapp { position: fixed; bottom: 30px; right: 30px; background: #25d366; color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; box-shadow: 0 10px 20px rgba(37,211,102,0.3); z-index: 1000; text-decoration: none; transition: 0.3s; }
    .floating-whatsapp:hover { transform: scale(1.1) rotate(10deg); }

    /* Header landing style - mais transparente */
    .header-landing { background: rgba(3, 7, 18, 0.5); border-bottom-color: rgba(0, 212, 255, 0.1); }

    /* Mobile Menu Button */
    .mobile-menu-btn {
      display: none;
      flex-direction: column;
      gap: 5px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 5px;
    }
    .mobile-menu-btn span {
      width: 25px;
      height: 3px;
      background: white;
      border-radius: 3px;
      transition: 0.3s;
    }
    .mobile-menu-btn.active span:nth-child(1) { transform: rotate(45deg) translate(6px, 6px); }
    .mobile-menu-btn.active span:nth-child(2) { opacity: 0; }
    .mobile-menu-btn.active span:nth-child(3) { transform: rotate(-45deg) translate(6px, -6px); }

    /* Mobile Menu Overlay */
    .mobile-menu {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(3, 7, 18, 0.98);
      backdrop-filter: blur(20px);
      z-index: 999;
      display: none;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .mobile-menu.active {
      display: flex;
      opacity: 1;
    }
    .mobile-nav {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      text-align: center;
    }
    .mobile-nav a {
      color: white;
      text-decoration: none;
      font-size: 1.3rem;
      font-weight: 600;
      padding: 0.8rem 1.5rem;
      border-radius: 12px;
      transition: 0.3s;
    }
    .mobile-nav a:hover {
      background: rgba(0, 212, 255, 0.1);
      color: var(--primary);
    }
    .mobile-divider {
      width: 80px;
      height: 2px;
      background: rgba(255,255,255,0.1);
      margin: 1rem 0;
    }
    .mobile-login {
      color: var(--text) !important;
      font-size: 1rem !important;
    }
    .mobile-cta {
      background: linear-gradient(135deg, var(--primary), var(--success)) !important;
      color: black !important;
      font-weight: 800 !important;
      padding: 1rem 2rem !important;
    }

    @media (max-width: 900px) {
      .nav-links, .header-ctas { display: none; }
      .global-header { padding: 1rem 5%; }
      .mobile-menu-btn { display: flex; }
    }
  </style>
</head>
<body>
  <div class="skip-links">
    <a href="#main-content" class="skip-link">Pular para conte√∫do principal</a>
    <a href="#main-nav" class="skip-link">Pular para navega√ß√£o</a>
  </div>
  <canvas id="neural-bg" class="neural-canvas"></canvas>
  <style is:global>
    .neural-canvas {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      z-index: -1; pointer-events: none; background: #030712;
    }
  </style>

  <header id="main-nav" class:list={["global-header", { "header-landing": isLanding }]}>
    <a href="/" class="logo-link">
      <div class="logo-box">N</div>
      <h1 class="logo-text">Get<span>Nexo</span></h1>
    </a>
    <nav class="nav-links">
      <a href="/produtos">Solu√ß√µes</a>
      <a href="/integracoes">Integra√ß√µes</a>
      <a href="/precos">Pre√ßos</a>
      <a href="/como-funciona">Como Funciona</a>
      <a href="/blog">Blog</a>
    </nav>
    <div class="header-ctas">
      <a href="/admin/login" class="btn-login">Entrar</a>
      <a href="/criar-bot" class="btn-start">Testar Gr√°tis</a>
    </div>
    <button id="mobile-menu-btn" class="mobile-menu-btn" aria-label="Menu">
      <span></span><span></span><span></span>
    </button>
  </header>

  <!-- Mobile Menu Overlay -->
  <div id="mobile-menu" class="mobile-menu">
    <nav class="mobile-nav">
      <a href="/produtos">üöÄ Solu√ß√µes</a>
      <a href="/integracoes">üîó Integra√ß√µes</a>
      <a href="/precos">üí∞ Pre√ßos</a>
      <a href="/como-funciona">‚öôÔ∏è Como Funciona</a>
      <a href="/blog">üìù Blog</a>
      <a href="/suporte">üõü Suporte</a>
      <div class="mobile-divider"></div>
      <a href="/admin/login" class="mobile-login">Entrar no Dashboard</a>
      <a href="/criar-bot" class="mobile-cta">Testar Gr√°tis ‚Üí</a>
    </nav>
  </div>

  <main id="main-content">
    <slot />
  </main>



  <!-- Accessibility Controls Panel -->
  <AccessibilityControls />

  <!-- Cookie Consent Banner -->
  <CookieConsent />

  <footer class="global-footer">
    <div class="footer-grid">
      <div class="footer-col">
        <a href="/" class="logo-link" style="margin-bottom:1rem;">
          <div class="logo-box">N</div>
          <h1 class="logo-text">Get<span>Nexo</span></h1>
        </a>
        <p style="font-size:0.9rem; color:#64748b; line-height:1.5;">A plataforma de IA para WhatsApp que vende sozinha. API Oficial Meta, PIX nativo e automa√ß√£o inteligente.</p>
        <div style="display:flex; gap:1rem; margin-top:1.5rem;">
          <a href="https://github.com/lelebrr" target="_blank" style="color:#64748b; transition:0.3s;" aria-label="GitHub">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
          </a>
          <a href="https://www.linkedin.com/company/getnexo" target="_blank" style="color:#64748b; transition:0.3s;" aria-label="LinkedIn">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
          </a>
        </div>
      </div>
      <div class="footer-col">
        <h4>Plataforma</h4>
        <a href="/produtos">Solu√ß√µes</a>
        <a href="/produtos/automacao">Automa√ß√£o IA</a>
        <a href="/produtos/vendas">Vendas & PIX</a>
        <a href="/integracoes">Integra√ß√µes</a>
        <a href="/precos">Pre√ßos</a>
      </div>
      <div class="footer-col">
        <h4>Recursos</h4>
        <a href="/blog">Blog</a>
        <a href="/documentacao">Documenta√ß√£o</a>
        <a href="/faq">FAQ</a>
        <a href="/changelog">Novidades</a>
        <a href="/api">API Reference</a>
      </div>
      <div class="footer-col">
        <h4>Empresa</h4>
        <a href="/sobre">Sobre N√≥s</a>
        <a href="/contato">Contato</a>
        <a href="/revenda">Programa de Revenda</a>
        <a href="/privacidade">Privacidade</a>
        <a href="/termos">Termos de Uso</a>
        <a href="/acessibilidade" title="Certifica√ß√µes de Acessibilidade WCAG 2.2 AA">Acessibilidade</a>
        <a href="/certificacoes" title="Ver todas as certifica√ß√µes">Certifica√ß√µes</a>
      </div>
    </div>
    <div class="footer-bottom">
      <p>¬© {new Date().getFullYear()} GetNexo - Intelig√™ncia Artificial Aplicada a Vendas. Todos os direitos reservados.</p>
    </div>
  </footer>

  <a href="https://wa.me/55..." target="_blank" class="floating-whatsapp" aria-label="Falar no WhatsApp">
    <svg width="30" height="30" viewBox="0 0 24 24" fill="currentColor"><path d="M12.031 6.172c-3.181 0-5.767 2.586-5.768 5.4 0 1.177.308 2.279.846 3.234l-.893 3.245 3.32-.871c.907.493 1.946.77 3.5.77 3.182 0 5.77-2.587 5.77-5.4 0-3.183-2.587-5.378-5.775-5.378zM12.031 2c5.523 0 10 4.477 10 10s-4.477 10-10 10-10-4.477-10-10 4.477-10 10-10z"/></svg>
  </a>

  <!-- Live Pulse Engine UI -->
  <div id="live-pulse" class="pulse-toast glass-panel" style="display:none;">
    <div class="pulse-icon">‚ö°</div>
    <div class="pulse-content">
      <span class="pulse-title">Nexus Work</span>
      <p id="pulse-message">Nexus acaba de processar um lead em S√£o Paulo.</p>
    </div>
  </div>

  <style is:global>
    .pulse-toast {
      position: fixed; bottom: 100px; left: 30px;
      padding: 1rem 1.5rem; display: flex; align-items: center; gap: 1rem;
      border-color: rgba(0, 255, 157, 0.2); z-index: 1000;
      animation: toastSlideIn 0.5s cubic-bezier(0.18, 0.89, 0.32, 1.28);
    }
    .pulse-icon { font-size: 1.2rem; color: #00ff9d; filter: drop-shadow(0 0 5px #00ff9d); }
    .pulse-title { display: block; font-size: 0.7rem; font-weight: 800; color: #00ff9d; text-transform: uppercase; letter-spacing: 1px; }
    #pulse-message { color: white; font-size: 0.85rem; font-weight: 600; margin: 0; }
    @keyframes toastSlideIn { from { transform: translateX(-100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
  </style>

  <div id="command-palette" class="palette-overlay" style="display:none;">
    <div class="palette-modal glass-panel">
      <div class="palette-header">
        <span class="palette-icon">üîç</span>
        <input type="text" id="palette-search" placeholder="O que voc√™ est√° procurando? (Esc para sair)" autocomplete="off" />
      </div>
      <div class="palette-results" id="palette-results">
        <div id="palette-quick-answer" class="quick-answer-box glass-panel" style="display:none;">
          <span class="qa-tag">Resposta IA</span>
          <p id="qa-text"></p>
        </div>
        <div class="result-group">
          <span class="group-title">Navega√ß√£o R√°pida</span>
          <a href="/" class="palette-item"><span>üè†</span> Home</a>
          <a href="/precos" class="palette-item"><span>üí∞</span> Planos e Pre√ßos</a>
          <a href="/produtos" class="palette-item"><span>üöÄ</span> Todas as Solu√ß√µes</a>
          <a href="/como-funciona" class="palette-item"><span>üõ†Ô∏è</span> Como Funciona</a>
        </div>
        <div class="result-group">
          <span class="group-title">Suporte e Comunidade</span>
          <a href="/contato" class="palette-item"><span>üìß</span> Fale com o Time</a>
          <a href="/faq" class="palette-item"><span>‚ùì</span> Perguntas Frequentes</a>
          <a href="https://github.com/lelebrr" target="_blank" class="palette-item"><span>üêô</span> GitHub Oficial</a>
        </div>
      </div>
      <div class="palette-footer">
        <span><kbd>Enter</kbd> para abrir</span>
        <span><kbd>‚Üë‚Üì</kbd> para navegar</span>
        <span><kbd>Esc</kbd> para fechar</span>
      </div>
    </div>
  </div>

  <style is:global>
    /* Command Palette Styles */
    .palette-overlay {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.8); backdrop-filter: blur(8px);
      z-index: 9999; display: flex; align-items: flex-start; justify-content: center;
      padding-top: 15vh;
    }
    .palette-modal {
      width: 90%; max-width: 600px;
      overflow: hidden; border-color: rgba(0, 212, 255, 0.2);
      box-shadow: 0 30px 60px rgba(0,0,0,0.5);
      animation: slideIn 0.2s ease-out;
    }
    @keyframes slideIn { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    .palette-header { display: flex; align-items: center; padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.05); gap: 1rem; }
    .palette-icon { font-size: 1.2rem; }
    #palette-search {
      background: transparent; border: none; outline: none;
      color: white; font-size: 1.1rem; width: 100%;
      font-family: inherit;
    }
    
    .palette-results { max-height: 400px; overflow-y: auto; padding: 1rem 0; }
    .result-group { margin-bottom: 1.5rem; }
    .group-title {
      font-size: 0.7rem; font-weight: 800; color: #475569;
      text-transform: uppercase; letter-spacing: 1px;
      padding: 0 1.5rem 0.5rem; display: block;
    }
    .palette-item {
      display: flex; align-items: center; gap: 1rem;
      padding: 0.8rem 1.5rem; color: #cbd5e1;
      text-decoration: none; font-weight: 600; font-size: 0.95rem;
      transition: 0.2s;
    }
    .palette-item:hover, .palette-item.active {
      background: rgba(0, 212, 255, 0.1); color: #00d4ff;
    }
    .palette-item span { font-size: 1.1rem; }

    /* Quick Answer Box */
    .quick-answer-box { margin: 1rem 1.5rem; padding: 1.2rem; border-color: rgba(0, 212, 255, 0.3); background: rgba(0, 212, 255, 0.05); }
    .qa-tag { font-size: 0.6rem; font-weight: 900; color: #00d4ff; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.5rem; display: block; }
    #qa-text { font-size: 0.9rem; color: #e2e8f0; line-height: 1.5; margin: 0; }

    .palette-footer {
      padding: 1rem 1.5rem; background: rgba(0,0,0,0.3);
      border-top: 1px solid rgba(255,255,255,0.05);
      display: flex; gap: 1.5rem; font-size: 0.7rem; color: #475569;
    }
    kbd {
      background: #1e293b; color: #94a3b8; padding: 0.1rem 0.4rem;
      border-radius: 4px; font-family: 'JetBrains Mono', monospace;
      border: 1px solid #334155; margin-right: 4px;
    }
  </style>

  <script is:inline>
    (function() {
      const palette = document.getElementById('command-palette');
      const searchInput = document.getElementById('palette-search');
      if (!palette || !searchInput) return;
      
      const items = palette.querySelectorAll('.palette-item');
      let activeIndex = -1;
  
      function openPalette() {
        palette.style.display = 'flex';
        searchInput.focus();
        activeIndex = -1;
      }
  
      function closePalette() {
        palette.style.display = 'none';
        searchInput.value = '';
      }
  
      window.addEventListener('keydown', (e) => {
        if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
          e.preventDefault();
          palette.style.display === 'none' ? openPalette() : closePalette();
        }
        
        if (palette.style.display === 'flex') {
          if (e.key === 'Escape') closePalette();
          
          if (e.key === 'ArrowDown') {
            e.preventDefault();
            activeIndex = (activeIndex + 1) % items.length;
            updateActiveItem();
          }
          if (e.key === 'ArrowUp') {
            e.preventDefault();
            activeIndex = (activeIndex - 1 + items.length) % items.length;
            updateActiveItem();
          }
          if (e.key === 'Enter' && activeIndex > -1) {
            items[activeIndex].click();
          }
        }
      });
  
      function updateActiveItem() {
        items.forEach((item, idx) => {
          item.classList.toggle('active', idx === activeIndex);
          if (idx === activeIndex) item.scrollIntoView({ block: 'nearest' });
        });
      }
  
      palette.addEventListener('click', (e) => {
        if (e.target === palette) closePalette();
      });
    })();
  </script>

  <script is:inline>
    (function() {
      // Neural Particle System
      const canvas = document.getElementById('neural-bg');
      const ctx = canvas?.getContext('2d');
      if (!canvas || !ctx) return;

      let particles = [];
      let mouse = { x: null, y: null, radius: 150 };
  
      function initNeural() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        particles = [];
        const density = (canvas.width * canvas.height) / 15000;
        for (let i = 0; i < density; i++) {
          particles.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            size: Math.random() * 2 + 0.5,
            speedX: Math.random() * 0.4 - 0.2,
            speedY: Math.random() * 0.4 - 0.2,
            color: 'rgba(0, 212, 255, 0.2)'
          });
        }
      }
  
      function animateNeural() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach((p, i) => {
          p.x += p.speedX; p.y += p.speedY;
          if (p.x > canvas.width || p.x < 0) p.speedX *= -1;
          if (p.y > canvas.height || p.y < 0) p.speedY *= -1;
  
          if (mouse.x) {
            let dx = mouse.x - p.x;
            let dy = mouse.y - p.y;
            let dist = Math.sqrt(dx*dx + dy*dy);
            if (dist < mouse.radius) {
              let force = (mouse.radius - dist) / mouse.radius;
              p.x -= dx * force * 0.01;
              p.y -= dy * force * 0.01;
            }
          }
  
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
          ctx.fill();
  
          for (let j = i + 1; j < particles.length; j++) {
            let p2 = particles[j];
            let dx = p.x - p2.x;
            let dy = p.y - p2.y;
            let dist = Math.sqrt(dx*dx + dy*dy);
            if (dist < 100) {
              ctx.strokeStyle = `rgba(0, 255, 157, ${0.1 * (1 - dist/100)})`;
              ctx.lineWidth = 0.5;
              ctx.beginPath(); ctx.moveTo(p.x, p.y); ctx.lineTo(p2.x, p2.y); ctx.stroke();
            }
          }
        });
        requestAnimationFrame(animateNeural);
      }
  
      window.addEventListener('mousemove', e => { mouse.x = e.x; mouse.y = e.y; });
      window.addEventListener('resize', initNeural);
      initNeural(); animateNeural();
  
      // Enhanced Palette Search Logic
      const searchInput = document.getElementById('palette-search');
      const items = document.querySelectorAll('.palette-item');
      
      searchInput?.addEventListener('input', (e) => {
        const q = e.target.value.toLowerCase().trim();
        items.forEach(item => {
          const text = item.textContent.toLowerCase();
          item.style.display = text.includes(q) ? 'flex' : 'none';
        });
      });
    })();
  </script>
  <!-- Chatwoot Widget -->
  <script is:inline>
    (function(d,t) {
      var BASE_URL="https://chat.getnexo.com.br";
      var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
      g.src=BASE_URL+"/packs/js/sdk.js";
      g.defer = true;
      g.async = true;
      s.parentNode.insertBefore(g,s);
      g.onload=function(){
        window.chatwootSDK.run({
          websiteToken: '5nhP3BH63pxF6HcNQLezaQCC',
          baseUrl: BASE_URL
        })
      }
    })(document,"script");
  </script>

  <script is:inline>
    // Live Pulse Engine Logic
    const pulseToast = document.getElementById('live-pulse');
    const pulseMsg = document.getElementById('pulse-message');
    const activities = [
        "Nexus acaba de processar um lead em S√£o Paulo.",
        "Novo bot GetNexo ativado em Curitiba.",
        "Recupera√ß√£o de carrinho de R$ 450 confirmada via WhatsApp.",
        "Cliente VIP conectado ao suporte multi-agente.",
        "Checkout PIX gerado com sucesso para 'Loja Tech'."
    ];

    function showPulse() {
        // Don't show if user is logged in
        if (localStorage.getItem('omnichat_token')) return;

        const msg = activities[Math.floor(Math.random() * activities.length)];
        pulseMsg.innerText = msg;
        pulseToast.style.display = 'flex';
        setTimeout(() => {
            pulseToast.style.animation = 'toastSlideIn 0.5s reverse forwards';
            setTimeout(() => {
                pulseToast.style.display = 'none';
                pulseToast.style.animation = 'toastSlideIn 0.5s forwards';
            }, 500);
        }, 4000);
    }
    
    // Initial check to start only if not logged in
    if (!localStorage.getItem('omnichat_token')) {
        setInterval(showPulse, 12000);
    }

    // Haptic UI Soundscape (Simulated with console for now + Audio logic)
    const playSound = (freq = 440, duration = 0.1) => {
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        oscillator.frequency.value = freq;
        gainNode.gain.setValueAtTime(0.02, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
        oscillator.start();
        oscillator.stop(audioCtx.currentTime + duration);
    };

    document.querySelectorAll('a, button').forEach(el => {
        el.addEventListener('mouseenter', () => playSound(1200, 0.05));
        el.addEventListener('click', () => playSound(800, 0.2));
    });

    // Quantum Contextual Search Logic
    const qaBox = document.getElementById('palette-quick-answer');
    const qaText = document.getElementById('qa-text');
    const context = {
        'pix': 'O GetNexo suporta PIX nativo no WhatsApp. O bot gera o QRC ou Copia e Cola instantaneamente e valida o pagamento via Webhook.',
        'ia': 'Usamos IA Generativa (Gemini/Llama) treinada com seus dados para responder leads de forma humanizada e estrat√©gica 24/7.',
        'contato': 'Voc√™ pode falar com nosso suporte via Command + K -> "Fale com o Time" ou direto pelo √≠cone do WhatsApp.',
        'pre√ßo': 'O plano Self-Hosted √© Gr√°tis. O plano Pro (Nuvem Gerenciada) custa R$ 97/m√™s com toda a infra inclusa.'
    };

    searchInput?.addEventListener('input', (e) => {
        const q = e.target.value.toLowerCase().trim();
        let matched = false;
        for (const key in context) {
            if (q.includes(key)) {
                qaText.innerText = context[key];
                qaBox.style.display = 'block';
                matched = true;
                break;
            }
        }
        if (!matched) qaBox.style.display = 'none';
    });

    // Quantum Transitions (Simulated)
    document.addEventListener('click', (e) => {
        const link = e.target.closest('a');
        if (link && link.origin === window.location.origin && !link.target) {
            document.body.style.opacity = '0.5';
            document.body.style.transition = '0.2s';
        }
    });
  </script>
</body>
</html>
