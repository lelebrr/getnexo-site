---
import '../styles/global.css';

interface Props {
  title: string;
  description?: string;
  type?: 'website' | 'article' | 'product';
  image?: string;
}

const { 
  title, 
  description = "Assistente de vendas no WhatsApp 100% grátis – IA que fecha vendas sozinho, sem nuvem, sem risco.",
  type = 'website',
  image = "https://getnexo.com.br/images/og-image.jpg"
} = Astro.props;

const canonicalUrl = `https://getnexo.com.br${Astro.url.pathname}`;

// JSON-LD Structured Data
const organizationSchema = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "GetNexo",
  "url": "https://getnexo.com.br",
  "logo": "https://getnexo.com.br/images/logo.png",
  "description": "Assistente de vendas no WhatsApp 100% grátis com IA local",
  "sameAs": [
    "https://github.com/lelebrr"
  ],
  "contactPoint": {
    "@type": "ContactPoint",
    "contactType": "customer service",
    "url": "https://chat.getnexo.com.br"
  }
};

const productSchema = {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "GetNexo - Assistente de Vendas WhatsApp",
  "applicationCategory": "BusinessApplication",
  "operatingSystem": "Windows, Linux, macOS",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "BRL"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.9",
    "ratingCount": "127"
  }
};

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://getnexo.com.br/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": title,
      "item": canonicalUrl
    }
  ]
};
---

<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{title} | GetNexo – Assistente de Vendas WhatsApp Grátis</title>
  
  <!-- SEO Meta Tags -->
  <meta name="description" content={description} />
  <meta name="keywords" content="assistente de vendas whatsapp, ia vendas whatsapp, automação whatsapp grátis, ia local whatsapp, getnexo, evolution api, n8n whatsapp, vendas 24h whatsapp, chatbot whatsapp gratis, automatizar whatsapp vendas" />
  <meta name="robots" content="index, follow, max-image-preview:large" />
  <meta name="author" content="GetNexo" />
  <link rel="canonical" href={canonicalUrl} />
  
  <!-- Open Graph -->
  <meta property="og:title" content={`${title} – GetNexo`} />
  <meta property="og:description" content={description} />
  <meta property="og:url" content={canonicalUrl} />
  <meta property="og:type" content={type} />
  <meta property="og:image" content={image} />
  <meta property="og:site_name" content="GetNexo" />
  <meta property="og:locale" content="pt_BR" />
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={`${title} – GetNexo`} />
  <meta name="twitter:description" content={description} />
  <meta name="twitter:image" content={image} />
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  
  <!-- Theme Color -->
  <meta name="theme-color" content="#0a0e17" />
  
  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json" set:html={JSON.stringify(organizationSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(productSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
</head>
<body>
  <!-- Skip Link for Accessibility -->
  <a href="#main-content" class="skip-link">Pular para o conteúdo</a>
  
  <!-- Particles Canvas -->
  <canvas class="canvas-particles" id="particles" aria-hidden="true"></canvas>

  <!-- Header -->
  <header role="banner">
    <a href="/" class="logo" aria-label="GetNexo - Página Inicial">GETNEXO</a>
    <nav role="navigation" aria-label="Menu principal">
      <a href="/">Início</a>
      <a href="/assistente-vendas-whatsapp">Assistente IA</a>
      <a href="/como-funciona">Como Funciona</a>
      <a href="/precos">Preços</a>
      <a href="/blog">Blog</a>
      <a href="/faq">FAQ</a>
      <a href="/sobre">Sobre</a>
      <a href="/contato">Contato</a>
      <a href="https://chat.getnexo.com.br" class="btn-cta" target="_blank" rel="noopener noreferrer">Testar Grátis →</a>
    </nav>
  </header>

  <!-- Main Content -->
  <main id="main-content" role="main">
    <slot />
  </main>

  <!-- Footer -->
  <footer role="contentinfo">
    <div class="footer-links">
      <a href="/sobre">Sobre</a> |
      <a href="/precos">Preços</a> |
      <a href="/faq">FAQ</a> |
      <a href="/blog">Blog</a> |
      <a href="/depoimentos">Depoimentos</a> |
      <a href="/documentacao">Docs</a> |
      <a href="/changelog">Changelog</a> |
      <a href="/contato">Contato</a> |
      <a href="/privacidade">Privacidade</a> |
      <a href="/api">API</a>
    </div>
    <p>© {new Date().getFullYear()} GetNexo – Assistente de Vendas WhatsApp 100% Grátis, IA Local e Automação Sem Nuvem.</p>
    <p>Dados Blindados (AES-256) + Zero Risco de Banimento + Roda em PC Comum</p>
  </footer>

  <!-- Scripts -->
  <script is:inline>
    // Optimized Particle System
    (function() {
      const canvas = document.getElementById('particles');
      if (!canvas) return;
      
      // Respect reduced motion preference
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      
      const ctx = canvas.getContext('2d');
      const particles = [];
      const maxParticles = 100; // Limit for performance
      
      function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      resize();
      window.addEventListener('resize', resize);
      
      const mouse = { x: null, y: null };
      
      document.addEventListener('mousemove', e => {
        mouse.x = e.clientX;
        mouse.y = e.clientY;
        
        if (particles.length < maxParticles) {
          particles.push({
            x: mouse.x,
            y: mouse.y,
            vx: (Math.random() - 0.5) * 3,
            vy: (Math.random() - 0.5) * 3,
            life: 50
          });
        }
      });
      
      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];
          p.x += p.vx;
          p.y += p.vy;
          p.life--;
          
          if (p.life <= 0) {
            particles.splice(i, 1);
            continue;
          }
          
          const alpha = p.life / 50;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.life / 10, 0, Math.PI * 2);
          ctx.fillStyle = `rgba(0, 212, 255, ${alpha})`;
          ctx.fill();
        }
        
        requestAnimationFrame(animate);
      }
      animate();
    })();
    
    // Scroll Fade-in Animation
    (function() {
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      }, { threshold: 0.1 });
      
      document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
    })();
  </script>
</body>
</html>
